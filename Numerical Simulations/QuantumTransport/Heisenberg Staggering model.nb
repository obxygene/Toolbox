(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10458,        274]
NotebookOptionsPosition[      9785,        254]
NotebookOutlinePosition[     10281,        272]
CellTagsIndexPosition[     10238,        269]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Pauli", " ", "\:77e9\:9635"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Num", " ", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sx", "=", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "1", "]"}], "/", "2"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Sy", "=", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "2", "]"}], "/", "2"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Sz", "=", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "3", "]"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"KronMultiple", "[", 
      RowBox[{"op_", ",", "pos_", ",", "Num_"}], "]"}], ":=", 
     RowBox[{"KroneckerProduct", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "pos"}], ",", "op", ",", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeisenbergHamiltonian", "[", 
      RowBox[{"Num_", ",", "J_", ",", "h_", ",", "boundarycond_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dim", "=", 
          RowBox[{"2", "^", "Num"}]}], ",", "H", ",", "neighbors", ",", 
         "twistTerm", ",", "interactionTerm", ",", "fieldTerm"}], "}"}], ",", 
       RowBox[{
       "(*", "\:751f\:6210\:6240\:6709\:76f8\:90bb\:683c\:70b9\:5bf9", "*)"}], 
       RowBox[{
        RowBox[{"neighbors", "=", 
         RowBox[{"Switch", "[", 
          RowBox[{"boundarycond", ",", "\"\<PBC\>\"", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"i", ",", "Num"}], "]"}], "+", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}], ",", 
           "\"\<OBC\>\"", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Num", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\:76f8\:4e92\:4f5c\:7528\:9879", "*)"}], 
        RowBox[{"interactionTerm", "=", 
         RowBox[{"J", " ", 
          RowBox[{"Total", "[", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"KronMultiple", "[", 
                 RowBox[{"Sx", ",", 
                  RowBox[{"neighbors", "[", 
                   RowBox[{"[", 
                    RowBox[{"kk", ",", "1"}], "]"}], "]"}], ",", "Num"}], 
                 "]"}], ".", 
                RowBox[{"KronMultiple", "[", 
                 RowBox[{"Sx", ",", 
                  RowBox[{"neighbors", "[", 
                   RowBox[{"[", 
                    RowBox[{"kk", ",", "2"}], "]"}], "]"}], ",", "Num"}], 
                 "]"}]}], ")"}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"KronMultiple", "[", 
                 RowBox[{"Sy", ",", 
                  RowBox[{"neighbors", "[", 
                   RowBox[{"[", 
                    RowBox[{"kk", ",", "1"}], "]"}], "]"}], ",", "Num"}], 
                 "]"}], ".", 
                RowBox[{"KronMultiple", "[", 
                 RowBox[{"Sy", ",", 
                  RowBox[{"neighbors", "[", 
                   RowBox[{"[", 
                    RowBox[{"kk", ",", "2"}], "]"}], "]"}], ",", "Num"}], 
                 "]"}]}], ")"}], " ", "+", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"KronMultiple", "[", 
                 RowBox[{"Sz", ",", 
                  RowBox[{"neighbors", "[", 
                   RowBox[{"[", 
                    RowBox[{"kk", ",", "1"}], "]"}], "]"}], ",", "Num"}], 
                 "]"}], ".", 
                RowBox[{"KronMultiple", "[", 
                 RowBox[{"Sz", ",", 
                  RowBox[{"neighbors", "[", 
                   RowBox[{"[", 
                    RowBox[{"kk", ",", "2"}], "]"}], "]"}], ",", "Num"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"kk", ",", "1", ",", 
               RowBox[{"Length", "[", "neighbors", "]"}]}], "}"}]}], "]"}], 
           "]"}]}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\:5916\:78c1\:573a\:9879", "*)"}], 
        RowBox[{"fieldTerm", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "ii"], "h", "*", 
             RowBox[{"KronMultiple", "[", 
              RowBox[{"Sz", ",", "ii", ",", "Num"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", "Num"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\:603b\:54c8\:5bc6\:987f\:91cf", "*)"}], 
        RowBox[{"H", "=", 
         RowBox[{"interactionTerm", "+", "fieldTerm"}]}], ";", 
        "\[IndentingNewLine]", "H"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.963706744406845*^9, 3.963706972460638*^9}, {
  3.9637087984347916`*^9, 3.9637088211202087`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"6145d484-fe41-a14f-9bee-9e27b0cb846d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HeisenbergHamiltonian", "[", 
   RowBox[{"Num", ",", " ", "1", ",", " ", "3", ",", " ", "\"\<PBC\>\""}], 
   "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.963706957590225*^9, 3.9637069805866413`*^9}, {
   3.9637088065839176`*^9, 3.9637088267110863`*^9}, 3.963713460991686*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"8a263f67-2f95-7d43-b603-0b7bac76542d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", 
      RowBox[{"-", "3"}], 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["1", "2"], "3", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", "2"], "0", 
      RowBox[{"-", "3"}], "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], "0", 
      RowBox[{"-", "7"}], 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "3"}], "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "3", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "5", "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "3", "0", 
      FractionBox["1", "2"], "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      RowBox[{"-", "3"}], 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "3", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.963706976245247*^9, 3.96370698109746*^9}, {
   3.963708802278307*^9, 3.9637088269167385`*^9}, 3.963713461713009*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"18746825-e6f1-6441-8a64-\
5284625041ef"]
}, Open  ]]
},
WindowSize->{934.5, 552},
WindowMargins->{{Automatic, -944.25}, {-93.375, Automatic}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (2023\:5e7412\:670812\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"65106962-4415-8d48-b48a-aa82c8a6ac70"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5765, 143, 570, "Input",ExpressionUUID->"6145d484-fe41-a14f-9bee-9e27b0cb846d"],
Cell[CellGroupData[{
Cell[6348, 167, 405, 7, 54, "Input",ExpressionUUID->"8a263f67-2f95-7d43-b603-0b7bac76542d"],
Cell[6756, 176, 3013, 75, 466, "Output",ExpressionUUID->"18746825-e6f1-6441-8a64-5284625041ef"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

